{% extends "base.html" %}

{% block content %}
  <div style="display: flex; justify-content: space-between; align-items: center;">
    <h1>TODO list</h1>
    <a href="{% url 'tasks:task-create' %}" class="btn btn-primary">
        Add task
    </a>
  </div>
  
  {% include "includes/search.html" %}
  
  {% if task_list %}
    {% for task in task_list %}
      <div style="display: flex; justify-content: space-between; align-items: center;">

        <h4>
          {{ task.name }}
          {% if task.is_done %}
            <span style="color: green">Done</span>
          {% else %}
            <span style="color: red">Not done</span>
          {% endif %}
        </h4>
      
          <!-- Form to change task status -->
        <form method="post" action="{% url 'tasks:task-change-status' task.id %}">
          {% csrf_token %}
          {% if task.is_done %}
            <input type="hidden" name="is_done" value="False">
            <button type="submit" class="btn btn-secondary">Undo</button>
          {% else %}
            <input type="hidden" name="is_done" value="True">
            <button type="submit" class="btn btn-success">Complete</button>
          {% endif %}
        </form>  
      </div>
      
        
        {% if task.deadline %}
          <p><u>Deadline:</u> {{ task.deadline }}</p>
        {% endif %}

        <p><b>Description:</b> {{ task.content|linebreaks }}</p>
        <p><u>Created:</u> {{ task.created_at }}</p>
        <p><u>Tags:</u> {% for tag in task.tags.all %}{{ tag.name }}{% endfor %}</p>
        <a href="{% url 'tasks:task-update' task.id %}">Update</a>
        <a href="{% url 'tasks:task-delete' task.id %}">Delete</a>
        <hr>
    {% endfor %}
  {% else %}
    <p>There are no tasks for you now</p>
  {% endif %}
{% endblock %}
